import{o as k,r as v,q as y,u as _,v as c,w as u,s as p,x as h,z as D}from"./vendor.a3bf09b0.js";import{n as w}from"./index.35d24c55.js";var T=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"force-page"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTip,expression:"isShowTip"}],staticClass:"force-tip",style:{top:(t.point&&t.point.top)+"px",left:(t.point&&t.point.left)+"px"}},[e("ul",[e("li",{on:{click:function(s){return t.delNode()}}},[t._v("\u5220\u9664\u8282\u70B9")])])]),e("el-button",{on:{click:function(s){return t.addNode()}}},[t._v("\u589E\u52A0\u8282\u70B9")])],1)},z=[];const S={name:"force-3",data(){return{isShowTip:!1,point:null,nodesData:null,linksData:null,nodes:null,texts:null,links:null,simulation:null}},mounted(){this.drawForce()},methods:{drawForce(){let t=[{name:"\u6842\u6797",id:0},{name:"\u5E7F\u5DDE",id:1},{name:"\u53A6\u95E8",id:2},{name:"\u676D\u5DDE",id:3},{name:"\u4E0A\u6D77",id:4},{name:"\u9752\u5C9B",id:5},{name:"\u5929\u6D25",id:6}];this.nodesData=t;let a=[{source:1,target:0},{source:0,target:1},{source:0,target:2},{source:0,target:3},{source:1,target:4},{source:1,target:5},{source:1,target:6}];this.linksData=a;const e=800,s=600;let i=k(t).force("link",v(a).id(n=>n.id)).force("charge",y().strength(-2e3)).force("center",_(e/2,s/2)).on("tick",this.ticked.bind(this));this.simulation=i;var r=c(u);let d=p(".force-page").append("svg").attr("id","chart").attr("width",e).attr("height",s).call(this.zoom()).append("g").attr("class","gWapper").attr("cursor","pointer"),m=d.append("g").selectAll("line").data(a).enter().append("line").attr("stroke","blue").attr("stroke-width",1).attr("marker-end","url(#arrow)");this.links=m,d.append("defs").append("marker").attr("id","arrow").attr("markerWidth",20).attr("markerHeight",20).attr("refX",8).attr("refY",8).attr("orient","auto").append("path").attr("fill","red").attr("d","M0 0 L8 8 L0 16Z");let g=d.append("g").selectAll("circle").data(t).enter().append("circle").attr("r",20).attr("opacity",.5).attr("fill",(n,l)=>r(l)).call(this.drag).on("contextmenu ",(n,l)=>{n.preventDefault(),this.isShowTip=!0,this.point={left:n.offsetX,top:n.offsetY,data:l}});this.nodes=g;let x=d.append("g").selectAll("text").data(t).enter().append("text").attr("text-anchor","middle").attr("dy","0.3em").text(n=>n.name).call(this.drag);this.texts=x},addNode(){let t=[{name:"\u6CB3\u5317",id:7},{name:"\u9752\u5C9B",id:5}],a=[{source:7,target:0},{source:5,target:1}],e=!1;for(let s of t)this.nodesData.findIndex(r=>r.id===s.id)===-1&&(this.nodesData.push(s),e=!0);for(let s of a){const i=this.linksData.findIndex(o=>o.source.id===s.source&&o.target.id===s.target),r=this.linksData.findIndex(o=>o.source.id===s.target&&o.target.id===s.source);i===-1&&(this.linksData.push(s),e=!0),r>-1&&(s.isReverse=!0,this.linksData.push(s),e=!0)}e||console.log("\u672A\u65B0\u589E\u8282\u70B9\u548C\u8FDE\u7EBF"),this.update("add")},delNode(){let t=this.nodesData.findIndex(a=>a.id===this.point.data.id);this.nodesData.splice(t,1),this.linksData.forEach((a,e)=>{(a.source.id===this.point.data.id||a.target.id===this.point.data.id)&&this.linksData.splice(e,1)}),this.isShowTip=!1,this.update("del")},update(t){var a=c(u);t==="add"?(this.nodes=this.nodes.data(this.nodesData,e=>e.name).enter().append("circle").merge(this.nodes),this.texts=this.texts.data(this.nodesData,e=>e.name).enter().append("text").merge(this.texts),this.links=this.links.data(this.linksData,e=>e.source.name+"-"+e.target.name).enter().append("line").merge(this.links)):t==="del"&&(this.nodes=this.nodes.data(this.nodesData,e=>e.name).exit().remove("circle").merge(this.nodes),this.texts=this.texts.data(this.nodesData,e=>e.name).exit().remove("text").merge(this.texts),this.links=this.links.data(this.linksData,e=>e.source.name+"-"+e.target.name).exit().remove("line").merge(this.links)),this.nodes.attr("r",20).attr("opacity",.5).attr("fill",(e,s)=>a(s)).call(h().on("start",this.dragstart).on("drag",this.dragged).on("end",this.dragend)).on("contextmenu ",(e,s)=>{e.preventDefault(),this.isShowTip=!0,this.point={left:e.offsetX,top:e.offsetY,data:s}}),this.texts=this.texts.attr("text-anchor","middle").attr("dy","0.3em").text(function(e){return e.name}).call(h().on("start",this.dragstart).on("drag",this.dragged).on("end",this.dragend)),this.links=this.links.attr("stroke",e=>e.isReverse?"none":"blue").attr("stroke-width",1).attr("marker-end","url(#arrow)"),this.simulation.nodes(this.nodesData),this.simulation.force("link").links(this.linksData),this.simulation.alpha(1).restart()},ticked(){this.links.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),this.nodes.attr("cx",t=>t.x).attr("cy",t=>t.y),this.texts.attr("x",t=>t.x).attr("y",t=>t.y),this.simulation.alpha()<.2&&(this.nodes.attr("cx",t=>(t.fx=t.x,t.x)).attr("cy",t=>(t.fy=t.y,t.y)),this.simulation.stop())},drag(t){function a(i,r){i.active||t.alphaTarget(.3).restart(),r.fx=r.x,r.fy=r.y}function e(i,r){r.fx=i.x,r.fy=i.y}function s(i,r){i.active||t.alphaTarget(0),r.fx=null,r.fy=null}return h().on("start",a).on("drag",e).on("end",s)},zoom(){var t=D().scaleExtent([1,10]).on("zoom",a);function a(e){p(".gWapper").attr("transform",e.transform)}return t}}},f={};var I=w(S,T,z,!1,N,"10ae0508",null,null);function N(t){for(let a in f)this[a]=f[a]}var A=function(){return I.exports}();export{A as default};
