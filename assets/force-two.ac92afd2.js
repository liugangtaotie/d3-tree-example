import{n as t,b as e,c as a,m as s,d as i,o as r,e as n,s as o,f as d,z as l}from"./index.50c65bbf.js";const h={};var c=t({name:"force-3",data:()=>({isShowTip:!1,point:null,nodesData:null,linksData:null,nodes:null,texts:null,links:null,simulation:null}),mounted(){this.drawForce()},methods:{drawForce(){let t=[{name:"桂林",id:0},{name:"广州",id:1},{name:"厦门",id:2},{name:"杭州",id:3},{name:"上海",id:4},{name:"青岛",id:5},{name:"天津",id:6}];this.nodesData=t;let d=[{source:1,target:0},{source:0,target:1},{source:0,target:2},{source:0,target:3},{source:1,target:4},{source:1,target:5},{source:1,target:6}];this.linksData=d;let l=e(t).force("link",a(d).id((t=>t.id))).force("charge",s().strength(-2e3)).force("center",i(400,300)).on("tick",this.ticked.bind(this));this.simulation=l;var h=r(n);let c=o(".force-page").append("svg").attr("id","chart").attr("width",800).attr("height",600).call(this.zoom()).append("g").attr("class","gWapper").attr("cursor","pointer"),p=c.append("g").selectAll("line").data(d).enter().append("line").attr("stroke","blue").attr("stroke-width",1).attr("marker-end","url(#arrow)");this.links=p,c.append("defs").append("marker").attr("id","arrow").attr("markerWidth",20).attr("markerHeight",20).attr("refX",8).attr("refY",8).attr("orient","auto").append("path").attr("fill","red").attr("d","M0 0 L8 8 L0 16Z");let u=c.append("g").selectAll("circle").data(t).enter().append("circle").attr("r",20).attr("opacity",.5).attr("fill",((t,e)=>h(e))).call(this.drag).on("contextmenu ",((t,e)=>{t.preventDefault(),this.isShowTip=!0,this.point={left:t.offsetX,top:t.offsetY,data:e}}));this.nodes=u;let f=c.append("g").selectAll("text").data(t).enter().append("text").attr("text-anchor","middle").attr("dy","0.3em").text((t=>t.name)).call(this.drag);this.texts=f},addNode(){let t=[{name:"河北",id:7},{name:"青岛",id:5}],e=[{source:7,target:0},{source:5,target:1}],a=!1;for(let s of t){-1===this.nodesData.findIndex((t=>t.id===s.id))&&(this.nodesData.push(s),a=!0)}for(let s of e){const t=this.linksData.findIndex((t=>t.source.id===s.source&&t.target.id===s.target)),e=this.linksData.findIndex((t=>t.source.id===s.target&&t.target.id===s.source));-1===t&&(this.linksData.push(s),a=!0),e>-1&&(s.isReverse=!0,this.linksData.push(s),a=!0)}this.update("add")},delNode(){let t=this.nodesData.findIndex((t=>t.id===this.point.data.id));this.nodesData.splice(t,1),this.linksData.forEach(((t,e)=>{t.source.id!==this.point.data.id&&t.target.id!==this.point.data.id||this.linksData.splice(e,1)})),this.isShowTip=!1,this.update("del")},update(t){var e=r(n);"add"===t?(this.nodes=this.nodes.data(this.nodesData,(t=>t.name)).enter().append("circle").merge(this.nodes),this.texts=this.texts.data(this.nodesData,(t=>t.name)).enter().append("text").merge(this.texts),this.links=this.links.data(this.linksData,(t=>t.source.name+"-"+t.target.name)).enter().append("line").merge(this.links)):"del"===t&&(this.nodes=this.nodes.data(this.nodesData,(t=>t.name)).exit().remove("circle").merge(this.nodes),this.texts=this.texts.data(this.nodesData,(t=>t.name)).exit().remove("text").merge(this.texts),this.links=this.links.data(this.linksData,(t=>t.source.name+"-"+t.target.name)).exit().remove("line").merge(this.links)),this.nodes.attr("r",20).attr("opacity",.5).attr("fill",((t,a)=>e(a))).call(d().on("start",this.dragstart).on("drag",this.dragged).on("end",this.dragend)).on("contextmenu ",((t,e)=>{t.preventDefault(),this.isShowTip=!0,this.point={left:t.offsetX,top:t.offsetY,data:e}})),this.texts=this.texts.attr("text-anchor","middle").attr("dy","0.3em").text((function(t){return t.name})).call(d().on("start",this.dragstart).on("drag",this.dragged).on("end",this.dragend)),this.links=this.links.attr("stroke",(t=>t.isReverse?"none":"blue")).attr("stroke-width",1).attr("marker-end","url(#arrow)"),this.simulation.nodes(this.nodesData),this.simulation.force("link").links(this.linksData),this.simulation.alpha(1).restart()},ticked(){this.links.attr("x1",(t=>t.source.x)).attr("y1",(t=>t.source.y)).attr("x2",(t=>t.target.x)).attr("y2",(t=>t.target.y)),this.nodes.attr("cx",(t=>t.x)).attr("cy",(t=>t.y)),this.texts.attr("x",(t=>t.x)).attr("y",(t=>t.y)),this.simulation.alpha()<.2&&(this.nodes.attr("cx",(t=>(t.fx=t.x,t.x))).attr("cy",(t=>(t.fy=t.y,t.y))),this.simulation.stop())},drag:t=>d().on("start",(function(e,a){e.active||t.alphaTarget(.3).restart(),a.fx=a.x,a.fy=a.y})).on("drag",(function(t,e){e.fx=t.x,e.fy=t.y})).on("end",(function(e,a){e.active||t.alphaTarget(0),a.fx=null,a.fy=null})),zoom:()=>l().scaleExtent([1,10]).on("zoom",(function(t){o(".gWapper").attr("transform",t.transform)}))}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"force-page"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTip,expression:"isShowTip"}],staticClass:"force-tip",style:{top:(t.point&&t.point.top)+"px",left:(t.point&&t.point.left)+"px"}},[a("ul",[a("li",{on:{click:function(e){return t.delNode()}}},[t._v("删除节点")])])]),a("el-button",{on:{click:function(e){return t.addNode()}}},[t._v("增加节点")])],1)}),[],!1,p,"10ae0508",null,null);function p(t){for(let e in h)this[e]=h[e]}var u=function(){return c.exports}();export{u as default};
